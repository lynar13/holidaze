import{u as F,e as I,b as l,j as e,l as y,m as v,d as N,y as i}from"./index-D4eH_S0J.js";import{S as k}from"./SafeImage-C2mfpUEJ.js";import{B as _}from"./BackButton-qfyEp7ve.js";const u="https://v2.api.noroff.dev/holidaze",L="606ada3d-e327-4dce-9000-3fe046f7fa64",M=()=>{var m,x,h,g,f,p,j;const{id:n}=F(),w=I(),[a,B]=l.useState(null),[P,S]=l.useState(!0),d={Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"X-Noroff-API-Key":L},T=(o=0)=>{const r=Math.floor(o),b=o%1>=.5,E=5-r-(b?1:0);return e.jsxs("span",{className:"text-yellow-500 text-sm ml-2",children:["★".repeat(r),b&&"½","☆".repeat(E),e.jsxs("span",{className:"ml-1 text-gray-500",children:["(",o.toFixed(1),")"]})]})};if(l.useEffect(()=>{(async()=>{try{const r=await N.get(`${u}/bookings/${n}?_venue=true&_customer=true`,{headers:d});B(r.data.data)}catch(r){console.error("Error fetching booking details:",r),i.error("Failed to load booking")}finally{S(!1)}})()},[n]),P)return e.jsx("div",{className:"text-center mt-10",children:"Loading..."});if(!a)return e.jsx("div",{className:"text-center mt-10",children:"Booking not found."});const s=a.venue,t=a.customer,C=y(new Date(a.dateFrom),"PPP"),D=y(new Date(a.dateTo),"PPP"),c=v(new Date(a.dateTo),new Date(a.dateFrom)),$=c*((s==null?void 0:s.price)||0),A=async()=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await N.delete(`${u}/bookings/${n}`,{headers:d}),i.success("Booking cancelled."),w("/customer")}catch(o){console.error("Cancel booking error:",o),i.error("Failed to cancel booking.")}};return e.jsxs("main",{className:"font-[Poppins] max-w-4xl mx-auto p-4",children:[e.jsxs("div",{className:"border-2 border-[#C07059] rounded-xl shadow p-6 space-y-6",children:[e.jsx(k,{src:((x=(m=s==null?void 0:s.media)==null?void 0:m[0])==null?void 0:x.url)||"https://placehold.co/600x300",alt:(s==null?void 0:s.name)||"Venue image",className:"w-full h-60 object-cover rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h1",{className:"text-5xl font-bold flex items-center",children:[s==null?void 0:s.name,(s==null?void 0:s.rating)!==void 0&&T(s.rating)]}),e.jsxs("p",{className:"text-gray-600",children:[(h=s==null?void 0:s.location)==null?void 0:h.address," ",(g=s==null?void 0:s.location)==null?void 0:g.city,","," ",(f=s==null?void 0:s.location)==null?void 0:f.country]}),e.jsxs("div",{className:"text-gray-700 space-y-1 mt-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Guests:"})," ",a.guests]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dates:"})," ",C," → ",D]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price per night:"})," $",s==null?void 0:s.price]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total nights:"})," ",c," night",c!==1?"s":""]}),e.jsxs("p",{className:"text-lg font-semibold mt-2",children:["Grand Total: $",$]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsx("h2",{className:"text-4xl font-semibold mb-3",children:"Customer Information"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{src:((p=t==null?void 0:t.avatar)==null?void 0:p.url)||"https://placehold.co/60x60",alt:((j=t==null?void 0:t.avatar)==null?void 0:j.alt)||(t==null?void 0:t.name)||"Customer Avatar",className:"w-14 h-14 rounded-full object-cover border"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:t==null?void 0:t.email})]})]})]}),e.jsx("button",{onClick:A,className:"mt-6 bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded-2xl text-sm",children:"Cancel Booking"})]})]}),e.jsx(_,{})]})};export{M as default};
