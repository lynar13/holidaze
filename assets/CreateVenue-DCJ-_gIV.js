import{f as $,e as E,b as r,y as m,j as a}from"./index-B1hlK_Kc.js";import{V as C,a as k}from"./VenuePreviewCard-wGYaMqcv.js";import{B}from"./BackButton-BgnLR4E7.js";import{c as F}from"./api-CP9qqBuO.js";import"./renderStars-CuFyzJ6G.js";function M(){const{user:n}=$(),c=E(),[o,g]=r.useState({name:"",description:"",price:"",maxGuests:"",rating:0,location:{address:"",city:"",country:""},meta:{wifi:!1,parking:!1,breakfast:!1,pets:!1},mediaUrls:[""]}),[u,y]=r.useState([""]),[b,f]=r.useState(!1),[h,p]=r.useState({});r.useEffect(()=>{n!=null&&n.venueManager||(m.error("Access denied: Only venue managers can create venues."),c("/customer"))},[n,c]);const v=async l=>{var x;l.preventDefault(),f(!0),p({});const{name:i,description:j,price:V,maxGuests:N,meta:w,location:d}=o,S={name:i.trim(),description:j.trim(),price:Number(V),maxGuests:Number(N),meta:w,location:{address:d.address.trim(),city:d.city.trim(),country:d.country.trim()},media:u.filter(e=>e.trim()).map((e,t)=>({url:e.trim(),alt:`Image ${t+1} of ${i}`}))};try{await F(S),m.success("Venue created successfully!"),c("/venue-manager")}catch(e){const t=(x=e==null?void 0:e.details)==null?void 0:x.errors;t!=null&&t.length?(t.forEach(s=>m.error(`${s.path}: ${s.message}`)),p(Object.fromEntries(t.map(s=>[s.path,s.message])))):(m.error("Failed to create venue."),console.error(e))}finally{f(!1)}};return a.jsxs("main",{className:"max-w-6xl mx-auto p-6 sm:p-10 bg-red-50 shadow-xl rounded-3xl mt-10 font-[Poppins]",children:[a.jsx("h1",{className:"text-5xl font-bold text-center text-gray-800 mb-10",children:"Create a New Venue"}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-10 items-start",children:[a.jsx(C,{form:o,setForm:g,mediaUrls:u,setMediaUrls:y,onSubmit:v,loading:b,submitLabel:"Create Venue",errors:h}),a.jsx(k,{venue:{...o,media:u.map((l,i)=>({url:l,alt:`Image ${i+1} of ${o.name}`}))}})]}),a.jsx(B,{})]})}export{M as default};
