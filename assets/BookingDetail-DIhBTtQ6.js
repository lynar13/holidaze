import{u as v,e as E,b as i,j as e,l as j,m as F,y as c}from"./index-B1hlK_Kc.js";import{S as b}from"./SafeImage-BHFg9Mcj.js";import{B as S}from"./BackButton-BgnLR4E7.js";import{a as T,d as A}from"./api-CP9qqBuO.js";import{r as $}from"./renderStars-CuFyzJ6G.js";const I="https://v2.api.noroff.dev/holidaze";function H(){var l,d,m,x,h,f,g;const{id:r}=v(),u=E(),[a,N]=i.useState(null),[k,y]=i.useState(!0);i.useEffect(()=>{(async()=>{try{const o=await fetch(`${I}/bookings/${r}?_venue=true&_customer=true`,{headers:T()});if(!o.ok)throw new Error("Fetch failed");const D=await o.json();N(D.data)}catch(o){console.error("Error fetching booking details:",o),c.error("Failed to load booking")}finally{y(!1)}})()},[r]);const w=async()=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await A(r),c.success("Booking cancelled."),u("/customer")}catch(p){console.error("Cancel booking error:",p),c.error("Failed to cancel booking.")}};if(k)return e.jsx("div",{className:"text-center mt-10",children:"Loading..."});if(!a)return e.jsx("div",{className:"text-center mt-10",children:"Booking not found."});const t=a.venue,s=a.customer,B=j(new Date(a.dateFrom),"PPP"),P=j(new Date(a.dateTo),"PPP"),n=F(new Date(a.dateTo),new Date(a.dateFrom)),C=n*((t==null?void 0:t.price)||0);return e.jsxs("main",{className:"font-[Poppins] max-w-4xl mx-auto p-4",children:[e.jsxs("div",{className:"border-2 border-[#C07059] rounded-xl shadow p-6 space-y-6",children:[e.jsx(b,{src:((d=(l=t==null?void 0:t.media)==null?void 0:l[0])==null?void 0:d.url)||"https://placehold.co/600x300",alt:(t==null?void 0:t.name)||"Venue image",className:"w-full h-60 object-cover rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-5xl font-bold flex items-center",children:t==null?void 0:t.name}),e.jsxs("p",{className:"text-gray-600 italic",children:["üìç",(m=t==null?void 0:t.location)==null?void 0:m.address," ",(x=t==null?void 0:t.location)==null?void 0:x.city,", ",(h=t==null?void 0:t.location)==null?void 0:h.country]}),e.jsx("p",{className:"justify-left flex",children:t.rating!==void 0&&$(t.rating)}),e.jsxs("div",{className:"text-gray-700 space-y-1 mt-4",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Guests:"})," ",a.guests]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dates:"})," ",B," ‚Üí ",P]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price per night:"})," $",t==null?void 0:t.price]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total nights:"})," ",n," night",n!==1?"s":""]}),e.jsxs("p",{className:"text-lg font-semibold mt-2",children:["Grand Total: $",C]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsx("h2",{className:"text-4xl font-semibold mb-3",children:"Customer Information"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{src:((f=s==null?void 0:s.avatar)==null?void 0:f.url)||"https://placehold.co/60x60",alt:((g=s==null?void 0:s.avatar)==null?void 0:g.alt)||(s==null?void 0:s.name)||"Customer Avatar",className:"w-14 h-14 rounded-full object-cover border"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:s==null?void 0:s.email})]})]})]}),e.jsx("button",{onClick:w,className:"mt-6 bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded-2xl text-sm",children:"Cancel Booking"})]})]}),e.jsx(S,{})]})}export{H as default};
