import{u as v,f as E,b as i,j as t,o as j,A as F,i as S,y as c,t as T}from"./index-BO5bb11k.js";import{S as b}from"./SafeImage-CFjQ_Mqk.js";import{B as A}from"./BackButton-Dzyr376S.js";import{r as $}from"./renderStars-kZBFfGCh.js";const I="https://v2.api.noroff.dev/holidaze";function z(){var l,d,m,x,h,f,g;const{id:r}=v(),u=E(),[a,N]=i.useState(null),[k,y]=i.useState(!0);i.useEffect(()=>{(async()=>{try{const o=await fetch(`${I}/bookings/${r}?_venue=true&_customer=true`,{headers:S()});if(!o.ok)throw new Error("Fetch failed");const D=await o.json();N(D.data)}catch(o){console.error("Error fetching booking details:",o),c.error("Failed to load booking")}finally{y(!1)}})()},[r]);const w=async()=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await T(r),c.success("Booking cancelled."),u("/customer")}catch(p){console.error("Cancel booking error:",p),c.error("Failed to cancel booking.")}};if(k)return t.jsx("div",{className:"text-center mt-10",children:"Loading..."});if(!a)return t.jsx("div",{className:"text-center mt-10",children:"Booking not found."});const e=a.venue,s=a.customer,B=j(new Date(a.dateFrom),"PPP"),P=j(new Date(a.dateTo),"PPP"),n=F(new Date(a.dateTo),new Date(a.dateFrom)),C=n*((e==null?void 0:e.price)||0);return t.jsxs("main",{className:"font-[Poppins] max-w-4xl mx-auto p-4",children:[t.jsxs("div",{className:"border-2 border-[#C07059] rounded-xl shadow p-6 space-y-6",children:[t.jsx(b,{src:((d=(l=e==null?void 0:e.media)==null?void 0:l[0])==null?void 0:d.url)||"https://placehold.co/600x300",alt:(e==null?void 0:e.name)||"Venue image",className:"w-full h-60 object-cover rounded-xl"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h1",{className:"text-5xl font-bold flex items-center",children:e==null?void 0:e.name}),t.jsxs("p",{className:"text-gray-600 italic",children:["üìç",(m=e==null?void 0:e.location)==null?void 0:m.address," ",(x=e==null?void 0:e.location)==null?void 0:x.city,", ",(h=e==null?void 0:e.location)==null?void 0:h.country]}),t.jsx("p",{className:"justify-left flex",children:e.rating!==void 0&&$(e.rating)}),t.jsxs("div",{className:"text-gray-700 space-y-1 mt-4",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Guests:"})," ",a.guests]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Dates:"})," ",B," ‚Üí ",P]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Price per night:"})," $",e==null?void 0:e.price]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Total nights:"})," ",n," night",n!==1?"s":""]}),t.jsxs("p",{className:"text-lg font-semibold mt-2",children:["Grand Total: $",C]})]}),t.jsxs("div",{className:"border-t pt-6 mt-6",children:[t.jsx("h2",{className:"text-4xl font-semibold mb-3",children:"Customer Information"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(b,{src:((f=s==null?void 0:s.avatar)==null?void 0:f.url)||"https://placehold.co/60x60",alt:((g=s==null?void 0:s.avatar)==null?void 0:g.alt)||(s==null?void 0:s.name)||"Customer Avatar",className:"w-14 h-14 rounded-full object-cover border"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:s==null?void 0:s.name}),t.jsx("p",{className:"text-gray-600 text-sm",children:s==null?void 0:s.email})]})]})]}),t.jsx("button",{onClick:w,className:"mt-6 bg-red-500 hover:bg-red-600 text-white font-semibold px-4 py-2 rounded-2xl text-sm",children:"Cancel Booking"})]})]}),t.jsx(A,{})]})}export{z as default};
