import{u as U,e as w,b as i,y as u,j as r}from"./index-B1hlK_Kc.js";import{V as B,a as F}from"./VenuePreviewCard-wGYaMqcv.js";import{B as L}from"./BackButton-BgnLR4E7.js";import{a as P,i as A}from"./api-CP9qqBuO.js";import"./renderStars-CuFyzJ6G.js";const D="https://v2.api.noroff.dev/holidaze";function H(){const{id:d}=U(),g=w(),[m,p]=i.useState(null),[c,f]=i.useState([]),[h,v]=i.useState(!0),[b,j]=i.useState(!1),[S,x]=i.useState({});i.useEffect(()=>{fetch(`${D}/venues/${d}`,{headers:P()}).then(s=>s.json()).then(s=>{var a,e;const n=s.data;p({...n,mediaUrls:((a=n.media)==null?void 0:a.map(o=>o.url))||[""]}),f(((e=n.media)==null?void 0:e.map(o=>o.url))||[""])}).catch(()=>u.error("Failed to load venue.")).finally(()=>v(!1))},[d]);const E=async s=>{var n;s.preventDefault(),j(!0),x({});try{const{name:a,description:e,price:o,maxGuests:t,meta:V,location:N}=m,$={name:a,description:e,price:Number(o),maxGuests:Number(t),meta:V,location:N,media:c.filter(l=>l.trim()).map((l,y)=>({url:l.trim(),alt:`Image ${y+1} of ${a}`}))};await A(d,$),u.success("Venue updated!"),g("/venue-manager")}catch(a){const e=(n=a.details)==null?void 0:n.errors;e!=null&&e.length?(e.map(t=>`${t.path}: ${t.message}`).forEach(t=>u.error(t)),x(Object.fromEntries(e.map(t=>[t.path,t.message])))):u.error("Failed to update venue."),console.error(a)}};return h||!m?r.jsx("p",{className:"p-4",children:"Loading venue..."}):r.jsxs("main",{className:"max-w-6xl mx-auto p-6 sm:p-10 bg-red-50 shadow-xl rounded-3xl mt-10 font-[Poppins]",children:[r.jsx("h1",{className:"text-4xl font-bold text-center text-gray-800 mb-10",children:"Edit Venue"}),r.jsxs("div",{className:"grid md:grid-cols-2 gap-10 items-start",children:[r.jsx(B,{form:m,setForm:p,mediaUrls:c,setMediaUrls:f,onSubmit:E,loading:b,submitLabel:"Update Venue",errors:S}),r.jsx(F,{venue:{...m,media:c.map(s=>({url:s}))}})]}),r.jsx(L,{})]})}export{H as default};
